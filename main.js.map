{"version":3,"file":"main.js","mappings":"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","sources":["webpack://weather-forecast/./src/scripts/Component.ts","webpack://weather-forecast/webpack/bootstrap","webpack://weather-forecast/webpack/runtime/global","webpack://weather-forecast/webpack/runtime/publicPath","webpack://weather-forecast/./src/scripts/services.js","webpack://weather-forecast/./src/scripts/localStorageController.js","webpack://weather-forecast/./src/scripts/pageHandler.js","webpack://weather-forecast/./src/scripts/App.js","webpack://weather-forecast/./src/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Component = void 0;\nclass Component {\n    constructor(root, state = {}) {\n        this.root = root;\n        this.state = state;\n        this.events = {};\n        root.innerHTML = this.render();\n        this.onMount();\n        Promise.resolve().then(() => this.subscribeToEvents());\n    }\n    render() {\n        return \"\";\n    }\n    onMount() { }\n    setState(patch) {\n        this.state = Object.assign(Object.assign({}, this.state), patch);\n        this.root.innerHTML = this.render();\n        this.subscribeToEvents();\n    }\n    subscribeToEvents() {\n        for (const [eventDesc, handler] of Object.entries(this.events)) {\n            const [event, query] = eventDesc.split(\"@\");\n            const emitter = this.root.querySelector(query);\n            emitter === null || emitter === void 0 ? void 0 : emitter.addEventListener(event, handler);\n        }\n    }\n}\nexports.Component = Component;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","const DEFAULT_CITY = \"Moscow\";\nconst API_WEATHER = \"c2e143f433c82cecf1f594126af9bfd5\";\n\nasync function getCityName(response) {\n  if (response.status !== 200) {\n    return DEFAULT_CITY;\n  }\n\n  const responseObj = await response.json();\n  return responseObj.geoplugin_city || DEFAULT_CITY;\n}\n\nexport async function getCurrentCity() {\n  const city = await fetch(\"http://www.geoplugin.net/json.gp\").then(\n    getCityName,\n    () => DEFAULT_CITY\n  );\n  return city;\n}\n\nexport async function getWeatherInfo(cityName) {\n  const url =\n    \"https://api.openweathermap.org/data/2.5/weather?\" +\n    `appid=${API_WEATHER}&q=${cityName}&units=metric`;\n\n  try {\n    const response = await fetch(url);\n    if (response.status !== 200) {\n      throw new Error(`Status code = ${response.status}`);\n    }\n    return await response.json();\n  } catch {\n    return null;\n  }\n}\n\nexport async function getSrcMap({\n  lat,\n  lon,\n  size: { height = 450, width = 450 },\n  z = 12,\n}) {\n  const url =\n    \"https://static-maps.yandex.ru/1.x/?\" +\n    `ll=${lon},${lat}&z=${z}&size=${width},${height}&l=map`;\n\n  return fetch(url).then(\n    (response) => {\n      if (response.status === 200) {\n        return url;\n      }\n      return null;\n    },\n    () => null\n  );\n}\n","const STORAGE_KEY = \"list of cities\";\n\nexport function getHistoryList() {\n  let historyList = JSON.parse(localStorage.getItem(STORAGE_KEY));\n  if (historyList === null) {\n    historyList = [];\n  }\n\n  return historyList;\n}\n\nexport function addCityToStorage(cityName) {\n  const historyList = getHistoryList();\n  const cityInd = historyList.indexOf(cityName);\n  if (cityInd !== -1) {\n    historyList.splice(cityInd, 1);\n  }\n\n  historyList.unshift(cityName);\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(historyList.slice(0, 10)));\n}\n","import { getSrcMap, getWeatherInfo } from \"./services\";\nimport { addCityToStorage } from \"./localStorageController\";\nimport unknownLocationImg from \"../images/unknown_location.png\";\n\nasync function updateMap(lat, lon) {\n  const map = document.querySelector(\".map\");\n  const src = await getSrcMap({\n    lat,\n    lon,\n    size: { width: map.width, height: map.height },\n  });\n  document.querySelector(\".map\").src = src ?? unknownLocationImg;\n}\n\nfunction deleteCityFromHistory(cityName) {\n  const list = document.querySelectorAll(\".history__city\");\n  for (let i = 0; i < list.length; i++) {\n    if (list[i].innerText === cityName) {\n      list[i].remove();\n      break;\n    }\n  }\n}\n\nfunction isElemContainsString(elem, string) {\n  return [].some.call(elem.childNodes, (item) =>\n    item.innerText.includes(string)\n  );\n}\n\nfunction addCityToHistoryList(cityName, parentElem) {\n  const cityElem = document.createElement(\"li\");\n  cityElem.innerText = cityName;\n  cityElem.classList.add(\"history__city\");\n  cityElem.addEventListener(\"click\", clickCityName);\n\n  if (isElemContainsString(parentElem, cityName)) {\n    deleteCityFromHistory(cityName);\n  }\n\n  parentElem.prepend(cityElem);\n  addCityToStorage(cityName);\n}\n\nexport function displayHistoryList(parentElem, stringArray) {\n  for (let i = stringArray.length - 1; i >= 0; i--) {\n    addCityToHistoryList(stringArray[i], parentElem);\n  }\n}\n\nexport async function updateData(inputCity) {\n  const weatherInfo = await getWeatherInfo(inputCity);\n  if (weatherInfo === null) {\n    alert(`Failed to get weather for ${inputCity}`);\n    return;\n  }\n\n  const {\n    coord: { lon, lat },\n    weather: [{ icon }],\n    main: { temp: temperature },\n    name: cityName,\n  } = weatherInfo;\n\n  document.querySelector(\".forecast__city\").innerText = cityName;\n  document.querySelector(\".forecast__temperature\").innerText = temperature;\n  document.querySelector(\n    \".forecast__image\"\n  ).src = `http://openweathermap.org/img/wn/${icon}@2x.png`;\n  addCityToHistoryList(cityName, document.querySelector(\".history__list\"));\n  updateMap(lat, lon);\n}\n\nfunction clickCityName(event) {\n  updateData(event.target.innerText);\n}\n\nexport function clickHistoryButton() {\n  const inputCity = document.querySelector(\".history__input-city\").value;\n  updateData(inputCity);\n}\n","import { Component } from \"./Component\";\nimport {\n  displayHistoryList,\n  updateData,\n  clickHistoryButton,\n} from \"./pageHandler\";\nimport { getCurrentCity } from \"./services\";\nimport { getHistoryList } from \"./localStorageController\";\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.events = {\n      \"click@.history__button\": clickHistoryButton,\n      \"keyup@.history__input-city\": (e) => {\n        const button = document.querySelector(\".history__button\");\n\n        if (e.target.value === \"\") {\n          button.disabled = true;\n        } else {\n          button.disabled = false;\n          if (e.key === \"Enter\") {\n            button.click();\n          }\n        }\n      },\n    };\n  }\n\n  onMount() {\n    const historyListElem = document.querySelector(\".history__list\");\n    displayHistoryList(historyListElem, getHistoryList());\n    getCurrentCity().then((cityName) => {\n      updateData(cityName);\n    });\n  }\n\n  render() {\n    return `<main class=\"main\">\n      <article class=\"forecast\">\n        <figure class=\"forecast__weather-info\">\n          <img\n            class=\"forecast__image\"\n            src=\"./images/unknown_weather.png\"\n            alt=\"weather image\"\n          />\n          <figcaption class=\"forecast__weather-text\">\n            <h2 class=\"forecast__city\">?</h2>\n            <p class=\"forecast__temperature\">?</p>\n          </figcaption>\n        </figure>\n      </article>\n      <article class=\"history\">\n        <div class=\"history__wrap\">\n          <input\n            type=\"text\"\n            placeholder=\"Enter city\"\n            class=\"history__input-city\"\n          />\n          <button\n            class=\"history__button fa-solid fa-magnifying-glass\"\n            disabled\n          ></button>\n        </div>\n        <ol class=\"history__list\"></ol>\n      </article>\n      <div class=\"map-wrap\">\n        <img\n          class=\"map\"\n          src=\"./images/unknown_location.png\"\n          alt=\"The city map\"\n        />\n      </div>\n    </main>`;\n  }\n}\n\nexport default App;\n","import \"normalize.css\";\nimport \"./styles/index.css\";\nimport App from \"./scripts/App\";\n\nconst root = document.getElementById(\"root\");\nnew App(root);\n"],"names":["exports","constructor","root","state","this","events","innerHTML","render","onMount","Promise","resolve","then","subscribeToEvents","setState","patch","Object","assign","eventDesc","handler","entries","event","query","split","emitter","querySelector","addEventListener","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","g","globalThis","Function","e","window","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","replace","p","DEFAULT_CITY","API_WEATHER","getCityName","response","status","json","responseObj","geoplugin_city","fetch","city","getWeatherInfo","cityName","url","getSrcMap","lat","lon","size","height","width","z","STORAGE_KEY","getHistoryList","historyList","JSON","parse","localStorage","getItem","i","updateMap","map","unknownLocationImg","addCityToHistoryList","parentElem","elem","string","cityElem","createElement","innerText","classList","add","clickCityName","some","call","childNodes","item","includes","list","querySelectorAll","remove","deleteCityFromHistory","prepend","cityInd","indexOf","splice","unshift","setItem","stringify","slice","addCityToStorage","updateData","inputCity","weatherInfo","alert","coord","weather","icon","temperature","main","temp","name","target","clickHistoryButton","value","App","args","button","disabled","key","click","stringArray","displayHistoryList","getCurrentCity","Component","getElementById"],"sourceRoot":""}